# μ‹¤μµ 2: Ingress Controller μ„¤μΉν•κΈ°

μ΄μ „ μ‹¤μµμ—μ„ μ°λ¦¬λ” μ—¬λ¬ μ„λΉ„μ¤λ¥Ό μ™Έλ¶€μ— λ…Έμ¶μ‹ν‚¤κΈ° μ„ν•΄ `LoadBalancer`λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ ν•κ³„λ¥Ό λ…ν™•ν μΈμ§€ν–μµλ‹λ‹¤. κ·Έ ν•΄κ²°μ±…μ΄ λ°”λ΅ **Ingress**λΌλ” κ²ƒλ„ μ•κ² λμ—μ£ .

Ingressκ°€ μ‹¤μ λ΅ λ™μ‘ν•λ ¤λ©΄ λ‘ κ°€μ§€ ν•µμ‹¬ μ”μ†κ°€ ν•„μ”ν•©λ‹λ‹¤.

1.  **Ingress λ¦¬μ†μ¤ (Resource):** νΈλν”½μ„ μ–΄λ–»κ² μ²λ¦¬ν• μ§€μ— λ€ν• **κ·μΉ™μ΄ λ‹΄κΈ΄ μ„¤κ³„λ„** (YAML νμΌ).
2.  **Ingress μ»¨νΈλ΅¤λ¬ (Controller):** ν΄λ¬μ¤ν„° μ•μ—μ„ μ‹¤ν–‰λλ©΄μ„, μ΄ μ„¤κ³„λ„λ¥Ό μ½κ³  κ·μΉ™μ— λ”°λΌ νΈλν”½μ„ μ‹¤μ λ΅ μ „λ‹¬ν•΄μ£Όλ” **λ‘λ‘ν• μ‹¤ν–‰μ(λ΅λ΄‡)**.

μ„¤κ³„λ„(`Ingress` λ¦¬μ†μ¤)λ¥Ό λ§λ“¤κΈ° μ „μ—, κ·Έ μ„¤κ³„λ„λ¥Ό μ½κ³  μ‹¤ν–‰ν•  λ΅λ΄‡(`Ingress Controller`)μ„ λ¨Όμ € ν΄λ¬μ¤ν„°μ— λ°°μΉν•΄μ•Ό ν•©λ‹λ‹¤. μ΄λ² μ‹¤μµμ—μ„λ” λ°”λ΅ κ·Έ Ingress Controllerλ¥Ό μ„¤μΉν•λ” κ³Όμ •μ„ μ§„ν–‰ν•©λ‹λ‹¤.

---

### π― ν•™μµ λ©ν‘

1.  Ingress λ¦¬μ†μ¤μ™€ Ingress Controllerμ κ΄€κ³„λ¥Ό μ΄ν•΄ν•λ‹¤.
2.  `minikube` ν™κ²½μ—μ„ `addon` κΈ°λ¥μ„ μ‚¬μ©ν•μ—¬ NGINX Ingress Controllerλ¥Ό μ†μ‰½κ² ν™μ„±ν™”ν•  μ μλ‹¤.
3.  Ingress Controllerκ°€ μ •μƒμ μΌλ΅ μ‹¤ν–‰ μ¤‘μΈμ§€ Pod μƒνƒλ¥Ό ν†µν•΄ ν™•μΈν•  μ μλ‹¤.
4.  μ™Έλ¶€μ—μ„ Ingress Controllerμ— μ ‘κ·Όν•  μ μλ” μ£Όμ†λ¥Ό ν™•μΈν•  μ μλ‹¤.

---

## 1\. Step 1: Ingress Controller ν™μ„±ν™”ν•κΈ°

λ‹¤ν–‰νλ„ `minikube`λ” κ°€μ¥ λ„λ¦¬ μ“°μ΄λ” **NGINX Ingress Controller**λ¥Ό μ• λ“μ¨(addon) ν•νƒλ΅ λ‚΄μ¥ν•κ³  μμ–΄, λ…λ Ήμ–΄ ν• μ¤„λ΅ λ§¤μ° κ°„λ‹¨ν•κ² μ„¤μΉν•  μ μμµλ‹λ‹¤.

ν„°λ―Έλ„μ—μ„ μ•„λ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ„Έμ”.

```bash
minikube addons enable ingress
```

μ μ‹ κΈ°λ‹¤λ¦¬λ©΄ λ‹¤μκ³Ό κ°™μ€ μ„±κ³µ λ©”μ‹μ§€λ¥Ό λ³Ό μ μμµλ‹λ‹¤.

```
π The 'ingress' addon is enabled
```

μ΄ λ…λ Ήμ–΄λ” μ—¬λ¬λ¶„μ ν΄λ¬μ¤ν„°μ— Ingress Controllerμ μ—­ν• μ„ μν–‰ν•  Nginx Podκ³Ό κ΄€λ ¨ μ„λΉ„μ¤ λ“±μ„ μλ™μΌλ΅ μ„¤μΉν•©λ‹λ‹¤.

## 2\. Step 2: μ„¤μΉ ν™•μΈν•κΈ°

μ •λ§λ΅ 'μ‹¤ν–‰μ λ΅λ΄‡'μ΄ μ λ°°μΉλμ—λ”μ§€ ν™•μΈν•΄ λ΄…μ‹λ‹¤. Ingress Controllerλ” λ³΄ν†µ `ingress-nginx` λΌλ” λ³„λ„μ μ‘μ—… κ³µκ°„(λ„¤μ„μ¤νμ΄μ¤)μ— μ„¤μΉλ©λ‹λ‹¤.

μ•„λ λ…λ Ήμ–΄λ΅ ν•΄λ‹Ή λ„¤μ„μ¤νμ΄μ¤μ Podλ“¤μ„ ν™•μΈν•©λ‹λ‹¤.

```bash
kubectl get pods -n ingress-nginx
```

**μμƒ μ¶λ ¥:**

```
NAME                                        READY   STATUS      RESTARTS   AGE
ingress-nginx-admission-create-xxxxx        0/1     Completed   0          60s
ingress-nginx-admission-patch-xxxxx         0/1     Completed   0          60s
ingress-nginx-controller-xxxxxxxxxx-xxxxx   1/1     Running     0          60s
```

`ingress-nginx-controller-...` λΌλ” μ΄λ¦„μ Podμ΄ `Running` μƒνƒλ΅ λ³΄μΈλ‹¤λ©΄ μ„±κ³µμ μΌλ΅ μ„¤μΉλ κ²ƒμ…λ‹λ‹¤. λ°”λ΅ μ΄ Podμ΄ μ°λ¦¬κ°€ μ•μΌλ΅ λ§λ“¤ λ¨λ“  Ingress κ·μΉ™λ“¤μ„ κ°μ‹ν•κ³  μ‹¤ν–‰ν•λ” ν•µμ‹¬μ μΈ μ—­ν• μ„ ν•©λ‹λ‹¤.

## 3\. Step 3: Ingress Controllerμ μ™Έλ¶€ μ£Όμ† ν™•μΈν•κΈ°

μ΄μ  'μ‹¤ν–‰μ(Controller)'λ” μ¤€λΉ„λμ—μµλ‹λ‹¤. κ·ΈλΌ μ™Έλ¶€μ νΈλν”½μ€ μ–΄λ–¤ μ£Όμ†λ΅ μ΄ μ‹¤ν–‰μμ—κ² μ°Ύμ•„μ™€μ•Ό ν• κΉμ”? Ingress Controller μμ²΄λ„ ν•λ‚μ `Service`λ¥Ό ν†µν•΄ μ™Έλ¶€μ— λ…Έμ¶λ©λ‹λ‹¤.

`minikube` ν™κ²½μ—μ„λ” μ•„λμ νΈλ¦¬ν• λ…λ Ήμ–΄λ΅ Ingress Controllerμ μ™Έλ¶€ μ ‘μ† μ£Όμ†λ¥Ό λ°”λ΅ ν™•μΈν•  μ μμµλ‹λ‹¤.

```bash
minikube service ingress-nginx-controller --url -n ingress-nginx
```

**μμƒ μ¶λ ¥:**

```
http://192.168.49.2:31180
```

_(IPμ£Όμ†μ™€ ν¬νΈ λ²νΈλ” μ—¬λ¬λ¶„μ ν™κ²½μ— λ”°λΌ λ‹¤λ¥Ό μ μμµλ‹λ‹¤.)_

μ΄ μ£Όμ†κ°€ λ°”λ΅ μ°λ¦¬ ν΄λ¬μ¤ν„°μ **λ‹¨μΌ μ§„μ…μ (Single Entrypoint)**, μ¦‰ 'μ •λ¬Έ' μ£Όμ†κ°€ λ©λ‹λ‹¤. μ•μΌλ΅ μ°λ¦¬λ” μ΄ μ£Όμ† ν•λ‚λ§ κΈ°μ–µν•λ©΄ λ©λ‹λ‹¤.

---

### β­ ν•µμ‹¬ μ •λ¦¬

- \*\*Ingress λ¦¬μ†μ¤(μ„¤κ³„λ„)\*\*λ” \*\*Ingress Controller(μ‹¤ν–‰μ)\*\*κ°€ μμ–΄μ•Όλ§ λ™μ‘ν•λ‹¤.
- Minikube ν™κ²½μ—μ„λ” `minikube addons enable ingress` λ…λ Ήμ–΄λ΅ NGINX Ingress Controllerλ¥Ό μ†μ‰½κ² μ„¤μΉν•  μ μλ‹¤.
- μ„¤μΉλ Ingress Controllerλ” `ingress-nginx` λ„¤μ„μ¤νμ΄μ¤μ—μ„ `Running` μƒνƒμ PodμΌλ΅ ν™•μΈν•  μ μλ‹¤.
- `minikube service --url` λ…λ Ήμ–΄λ΅ Ingress Controllerμ μ™Έλ¶€ μ ‘μ† μ£Όμ†(μ •λ¬Έ μ£Όμ†)λ¥Ό ν™•μΈν•  μ μλ‹¤.

μ΄μ  μ°λ¦¬ ν΄λ¬μ¤ν„°μ 'μ •λ¬Έ'μ΄ μ„Έμ›μ΅μµλ‹λ‹¤. λ‹¤μ μ‹¤μµμ—μ„λ” μ΄ μ •λ¬Έμ„ ν†µκ³Όν•λ” νΈλν”½μ„ μ–΄λ–»κ² λ¶„λ°°ν• μ§€ μ²« λ²μ§Έ 'μ•λ‚΄ κ·μΉ™(Ingress λ¦¬μ†μ¤)'μ„ λ§λ“¤μ–΄ λ³΄κ² μµλ‹λ‹¤.
